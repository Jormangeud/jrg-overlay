=== modified file 'cuneiform_src/CMakeLists.txt'
--- a/cuneiform_src/CMakeLists.txt	2010-09-16 08:41:29 +0000
+++ b/cuneiform_src/CMakeLists.txt	2017-06-01 17:55:52 +0000
@@ -17,6 +17,7 @@
     if (HAVE_GCCVISIBILITY)
 	    add_definitions("-fvisibility=hidden -DHAVE_GCCVISIBILITY")
     endif()
+    set(CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -Wno-narrowing" )
 endif()
 
 # Stop MSVC complaints about POSIX functions.
@@ -40,6 +41,9 @@
     include_directories(${ImageMagick_Magick++_INCLUDE_DIR})
     message(STATUS "ImageMagick++ found at ${ImageMagick_Magick++_INCLUDE_DIR}.")
     set(cli_ext_libs ${ImageMagick_Magick++_LIBRARY})
+    include_directories(${ImageMagick_INCLUDE_DIRS})
+    add_definitions(-DMAGICKCORE_QUANTUM_DEPTH=16)
+    add_definitions(-DMAGICKCORE_HDRI_ENABLE=0)
 else()
     set(USE_MAGICK FALSE)
     message(STATUS "ImageMagick++ not found. Only uncompressed BMP images supported.")

=== modified file 'cuneiform_src/Kern/dif/src/stick.h'
--- a/cuneiform_src/Kern/dif/src/stick.h	2009-09-19 15:08:05 +0000
+++ b/cuneiform_src/Kern/dif/src/stick.h	2017-06-01 17:55:52 +0000
@@ -227,7 +227,7 @@
 	    L->num_concs<3                              &&		\
 	    (L->mount[2]>0||L->conc[0]>0&&L->conc[4]>0) &&		\
 	    R->mount[0]>0  && R->mount[4]>0  && R->m_meandr<4 )		\
-		dis += (tab) * min ((R->mount[0] + R->mount[4]), 4);	\
+		dis += (tab) * MIN ((R->mount[0] + R->mount[4]), 4);	\
 	}
 
 #define FOUR_CONC(l,r,tab)                                      \

=== modified file 'cuneiform_src/Kern/fon/src/p2_clu.c'
--- a/cuneiform_src/Kern/fon/src/p2_clu.c	2010-02-08 10:34:20 +0000
+++ b/cuneiform_src/Kern/fon/src/p2_clu.c	2017-06-01 17:55:52 +0000
@@ -120,7 +120,7 @@
 //   (now 128*64+... > 8192)
 //
 // working buffer
-static char mybuffer[MAX(2*MAXSYM * sizeof(int16_t), max(2*sizeof (welet ),sizeof(access_tab)))];
+static char mybuffer[MAX(2*MAXSYM * sizeof(int16_t), MAX(2*sizeof (welet ),sizeof(access_tab)))];
 welet *welBuf = (welet *) mybuffer;
 welet *dist_wel = (welet *) (mybuffer + MAX(MAXSYM * sizeof(int16_t),
 		sizeof(welet))); // use as

=== modified file 'cuneiform_src/Kern/hhh/lst3_win.h'
--- a/cuneiform_src/Kern/hhh/lst3_win.h	2009-09-19 20:07:01 +0000
+++ b/cuneiform_src/Kern/hhh/lst3_win.h	2017-06-01 17:55:52 +0000
@@ -835,17 +835,17 @@
   d_down=abs(f1->down - f2->down);  \
   dv=abs( ( (f1->up+f1->down) - (f2->up+f2->down) )>>1 );\
   if(d_up < dv) dv=d_up; if(d_down < dv) dv=d_down;         \
-  dist=abs(max(f1->left,f2->left) - min(f1->right,f2->right));\
+  dist=abs(MAX(f1->left,f2->left) - MIN(f1->right,f2->right));\
   dist+=par.kv*dv; \
 } */
 #define dist_frm(f1,f2,dist) { int dv,d_up;\
   d_up=  abs(f1->up - f2->up); \
   dv=abs(f1->down - f2->down); if(d_up < dv) dv=d_up; \
-  dist=abs(max(f1->left,f2->left) - min(f1->right,f2->right));\
+  dist=abs(MAX(f1->left,f2->left) - MIN(f1->right,f2->right));\
   dist+=par.kv*dv; \
 }
 
-#define DIST_V(u1,d1,u2,d2) (min(d1,d2)-max(u1,u2))
+#define DIST_V(u1,d1,u2,d2) (MIN(d1,d2)-MAX(u1,u2))
 
 #define DV_FRM(a,b) DIST_V(a->up,a->down,b->up,b->down)
 

=== modified file 'cuneiform_src/Kern/hrstr/stic-mac.h'
--- a/cuneiform_src/Kern/hrstr/stic-mac.h	2009-09-19 19:52:48 +0000
+++ b/cuneiform_src/Kern/hrstr/stic-mac.h	2017-06-01 17:55:52 +0000
@@ -138,7 +138,7 @@
 	    L->num_concs<3                              &&		\
 	    (L->mount[2]>0||L->conc[0]>0&&L->conc[4]>0) &&		\
 	    R->mount[0]>0  && R->mount[4]>0  && R->m_meandr<4 )		\
-		dis += (tab) * min ((R->mount[0] + R->mount[4]), 4);	\
+		dis += (tab) * MIN((R->mount[0] + R->mount[4]), 4);	\
 	}
 
 
@@ -241,8 +241,8 @@
 	{                                             \
 	int16_t t,m;                                      \
 	t =  abs(L->mount[i]-R->mount[i]) ;           \
-	m =  min(L->mount[i],R->mount[i]) ;           \
-	if( t>max(((wid)>>1),dist) || m==0 )          \
+	m =  MIN(L->mount[i],R->mount[i]) ;           \
+	if( t>MAX(((wid)>>1),dist) || m==0 )          \
 		dis += (tab)*t;                       \
 	}
 

=== modified file 'cuneiform_src/Kern/icrashreport/wtl/include/atlapp.h'
--- a/cuneiform_src/Kern/icrashreport/wtl/include/atlapp.h	2009-09-19 21:19:02 +0000
+++ b/cuneiform_src/Kern/icrashreport/wtl/include/atlapp.h	2017-06-01 17:55:52 +0000
@@ -258,7 +258,7 @@
   {
 	if(lpstrDest == NULL || lpstrSrc == NULL || nLength <= 0)
 		return NULL;
-	int nLen = min(lstrlen(lpstrSrc), nLength - 1);
+	int nLen = MIN(lstrlen(lpstrSrc), nLength - 1);
 	char* lpstrRet = (char*)memcpy(lpstrDest, lpstrSrc, nLen * sizeof(TCHAR));
 	lpstrDest[nLen] = 0;
 	return lpstrRet;
@@ -277,7 +277,7 @@
   {
 	if(lpstrDest == NULL || lpstrSrc == NULL || nLength <= 0)
 		return NULL;
-	int nLen = min(lstrlenA(lpstrSrc), nLength - 1);
+	int nLen = MIN(lstrlenA(lpstrSrc), nLength - 1);
 	char* lpstrRet = (char*)memcpy(lpstrDest, lpstrSrc, nLen * sizeof(char));
 	lpstrDest[nLen] = 0;
 	return lpstrRet;
@@ -787,7 +787,7 @@
 		}
 		else if(cchCount == _TRUNCATE)
 		{
-			cchCount = min(cchDest - 1, size_t(lstrlenA(lpstrSrc)));
+			cchCount = MIN(cchDest - 1, size_t(lstrlenA(lpstrSrc)));
 			nRet = STRUNCATE;
 		}
 		else if(cchDest <= cchCount)
@@ -814,7 +814,7 @@
 		}
 		else if(cchCount == _TRUNCATE)
 		{
-			cchCount = min(cchDest - 1, size_t(lstrlenW(lpstrSrc)));
+			cchCount = MIN(cchDest - 1, size_t(lstrlenW(lpstrSrc)));
 			nRet = STRUNCATE;
 		}
 		else if(cchDest <= cchCount)

=== modified file 'cuneiform_src/Kern/icrashreport/wtl/include/atlmisc.h'
--- a/cuneiform_src/Kern/icrashreport/wtl/include/atlmisc.h	2009-09-19 21:19:02 +0000
+++ b/cuneiform_src/Kern/icrashreport/wtl/include/atlmisc.h	2017-06-01 17:55:52 +0000
@@ -1856,7 +1856,7 @@
 				else
 				{
 					nItemLen = lstrlen(pstrNextArg);
-					nItemLen = max(1, nItemLen);
+					nItemLen = MAX(1, nItemLen);
 				}
 				break;
 			}
@@ -1872,7 +1872,7 @@
 				else
 				{
 					nItemLen = (int)wcslen(pstrNextArg);
-					nItemLen = max(1, nItemLen);
+					nItemLen = MAX(1, nItemLen);
 				}
 #else // _UNICODE
 				const char * pstrNextArg = va_arg(argList, const char *);
@@ -1887,7 +1887,7 @@
 #else
 					nItemLen = lstrlenA(pstrNextArg);
 #endif
-					nItemLen = max(1, nItemLen);
+					nItemLen = MAX(1, nItemLen);
 				}
 #endif // _UNICODE
 				break;
@@ -1908,7 +1908,7 @@
 #else
 					nItemLen = lstrlenA(pstrNextArg);
 #endif
-					nItemLen = max(1, nItemLen);
+					nItemLen = MAX(1, nItemLen);
 				}
 				break;
 			}
@@ -1924,7 +1924,7 @@
 				else
 				{
 					nItemLen = (int)wcslen(pstrNextArg);
-					nItemLen = max(1, nItemLen);
+					nItemLen = MAX(1, nItemLen);
 				}
 				break;
 			}
@@ -1933,9 +1933,9 @@
 			// adjust nItemLen for strings
 			if (nItemLen != 0)
 			{
-				nItemLen = max(nItemLen, nWidth);
+				nItemLen = MAX(nItemLen, nWidth);
 				if (nPrecision != 0)
-					nItemLen = min(nItemLen, nPrecision);
+					nItemLen = MIN(nItemLen, nPrecision);
 			}
 			else
 			{
@@ -1953,7 +1953,7 @@
 					else
 						va_arg(argList, int);
 					nItemLen = 32;
-					nItemLen = max(nItemLen, nWidth + nPrecision);
+					nItemLen = MAX(nItemLen, nWidth + nPrecision);
 					break;
 
 #ifndef _ATL_USE_CSTRING_FLOAT
@@ -1979,7 +1979,7 @@
 				case _T('G'):
 					va_arg(argList, double);
 					nItemLen = 128;
-					nItemLen = max(nItemLen, nWidth + nPrecision);
+					nItemLen = MAX(nItemLen, nWidth + nPrecision);
 					break;
 				case _T('f'):
 					{
@@ -1988,7 +1988,7 @@
 						// 309 zeroes == max precision of a double
 						// 6 == adjustment in case precision is not specified,
 						//   which means that the precision defaults to 6
-						int cchLen = max(nWidth, 312 + nPrecision + 6);
+						int cchLen = MAX(nWidth, 312 + nPrecision + 6);
 						CTempBuffer<TCHAR, _WTL_STACK_ALLOC_THRESHOLD> buff;
 						char* pszTemp = buff.Allocate(cchLen);
 						if(pszTemp != NULL)
@@ -2007,7 +2007,7 @@
 				case _T('p'):
 					va_arg(argList, void*);
 					nItemLen = 32;
-					nItemLen = max(nItemLen, nWidth + nPrecision);
+					nItemLen = MAX(nItemLen, nWidth + nPrecision);
 					break;
 
 				// no output

=== modified file 'cuneiform_src/Kern/include/minmax.h'
--- a/cuneiform_src/Kern/include/minmax.h	2009-09-18 08:29:58 +0000
+++ b/cuneiform_src/Kern/include/minmax.h	2017-06-01 17:55:52 +0000
@@ -67,11 +67,11 @@
 #define MAX(a,b) (((a)>(b))?(a):(b))
 #endif
 
-#ifndef min
-#define min(a,b) (((a)>(b))?(b):(a))
-#endif
-#ifndef max
-#define max(a,b) (((a)>(b))?(a):(b))
-#endif
+//#ifndef min
+//#define min(a,b) (((a)>(b))?(b):(a))
+//#endif
+//#ifndef max
+//#define max(a,b) (((a)>(b))?(a):(b))
+//#endif
 
 #endif

=== modified file 'cuneiform_src/Kern/include/utf8-tables.h'
--- a/cuneiform_src/Kern/include/utf8-tables.h	2010-01-29 14:25:12 +0000
+++ b/cuneiform_src/Kern/include/utf8-tables.h	2017-06-01 17:55:52 +0000
@@ -68,7 +68,7 @@
 #endif
 
 
-const char win1250_to_utf8[][4] = {
+const unsigned char win1250_to_utf8[][4] = {
   {0, 0, 0, 0},
   {1, 0, 0, 0},
   {2, 0, 0, 0},
@@ -328,7 +328,7 @@
 };
 
 
-const char win1251_to_utf8[][4] = {
+const unsigned char win1251_to_utf8[][4] = {
   {0, 0, 0, 0},
   {1, 0, 0, 0},
   {2, 0, 0, 0},
@@ -587,7 +587,7 @@
   {209, 143, 0, 0},
 };
 
-const char win1252_to_utf8[][4] = {
+const unsigned char win1252_to_utf8[][4] = {
   {0, 0, 0, 0},
   {1, 0, 0, 0},
   {2, 0, 0, 0},
@@ -847,7 +847,7 @@
 };
 
 
-const char win1254_to_utf8[][4] = {
+const unsigned char win1254_to_utf8[][4] = {
   {0, 0, 0, 0},
   {1, 0, 0, 0},
   {2, 0, 0, 0},
@@ -1107,7 +1107,7 @@
 };
 
 
-const char win1257_to_utf8[][4] = {
+const unsigned char win1257_to_utf8[][4] = {
   {0, 0, 0, 0},
   {1, 0, 0, 0},
   {2, 0, 0, 0},

=== modified file 'cuneiform_src/Kern/lns32/src/lns.cpp'
--- a/cuneiform_src/Kern/lns32/src/lns.cpp	2010-01-29 14:25:12 +0000
+++ b/cuneiform_src/Kern/lns32/src/lns.cpp	2017-06-01 17:55:52 +0000
@@ -190,8 +190,8 @@
          break;   // keep lines, if lack
       if (li.Flags & LI_NOISE)
          continue;
-      Point32 Mn; Mn.x = MIN(li.A.x,li.B.x);   Mn.y = min(li.A.y,li.B.y);
-      Point32 Mx; Mx.x = MAX(li.A.x,li.B.x);   Mx.y = max(li.A.y,li.B.y);
+      Point32 Mn; Mn.x = MIN(li.A.x,li.B.x);   Mn.y = MIN(li.A.y,li.B.y);
+      Point32 Mx; Mx.x = MAX(li.A.x,li.B.x);   Mx.y = MAX(li.A.y,li.B.y);
       if ((Mn.y < imgrect.top + 50) || (Mx.y > imgrect.bottom - 50))
       {
          if (!__HasCorners(li, plti, TRUE))
@@ -213,8 +213,8 @@
          continue;
       if (vcnt < 5)
          break;   // keep lines, if lack
-      Point32 Mn; Mn.x = MIN(li.A.x,li.B.x);   Mn.y = min(li.A.y,li.B.y);
-      Point32 Mx; Mx.x = MAX(li.A.x,li.B.x);   Mx.y = max(li.A.y,li.B.y);
+      Point32 Mn; Mn.x = MIN(li.A.x,li.B.x);   Mn.y = MIN(li.A.y,li.B.y);
+      Point32 Mx; Mx.x = MAX(li.A.x,li.B.x);   Mx.y = MAX(li.A.y,li.B.y);
       if ((Mn.x < imgrect.left + 50) || (Mx.x > imgrect.right - 50))
       {
          if (!__HasCorners(li, plti, FALSE))

=== modified file 'cuneiform_src/Kern/lns32/src/lnscheck.cpp'
--- a/cuneiform_src/Kern/lns32/src/lnscheck.cpp	2010-01-29 14:25:12 +0000
+++ b/cuneiform_src/Kern/lns32/src/lnscheck.cpp	2017-06-01 17:55:52 +0000
@@ -66,8 +66,8 @@
 #include "decl.h"
 
 typedef Point16 XPoint16;
-#define maxi max
-#define mini min
+#define maxi MAX
+#define mini MIN
 #define PPSArray TArray
 
 #define CONSOLE /* This can also be printf. */

=== modified file 'cuneiform_src/Kern/lns32/src/xydim.h'
--- a/cuneiform_src/Kern/lns32/src/xydim.h	2009-09-18 08:29:58 +0000
+++ b/cuneiform_src/Kern/lns32/src/xydim.h	2017-06-01 17:55:52 +0000
@@ -86,8 +86,8 @@
 					);
 			};
          void expandX( int l, int r ){
-				left = min( left, l );
-				right = max( right, r);
+				left = MIN( left, l );
+				right = MAX( right, r);
 			};
 
 	};
@@ -115,8 +115,8 @@
 				);
 			};
          void expandY( int b, int t ){
-				bottom = min( bottom, b );
-				top = max( top, t );
+				bottom = MIN( bottom, b );
+				top = MAX( top, t );
 			};
 
 	};
@@ -145,10 +145,10 @@
 						 );
 			};
          void restrictXY( int x1, int x2, int y1, int y2 ){
-				left 		= 	max( left, x1 );
-				right		=  min( right, x2 );
-				bottom	= 	max(bottom, y1);
-				top    	=  min(top, y2);
+				left 		= 	MAX( left, x1 );
+				right		=  MIN( right, x2 );
+				bottom	= 	MAX(bottom, y1);
+				top    	=  MIN(top, y2);
 			};
          void expandXY( TXYDim* brother ){
 				expandX( brother->left, brother->right );

=== modified file 'cuneiform_src/Kern/puma/main/dll.cpp'
--- a/cuneiform_src/Kern/puma/main/dll.cpp	2010-11-03 08:30:35 +0000
+++ b/cuneiform_src/Kern/puma/main/dll.cpp	2017-06-01 17:55:52 +0000
@@ -75,7 +75,7 @@
 #include "compat_defs.h"
 
 //////////////////////////////////////////////////////////////////GLOBAL VARIABLES
-static char				 s_szVersion[] = "Version OCR Puma "__DATE__".";
+static char				 s_szVersion[] = "Version OCR Puma " __DATE__ ".";
 static uint16_t            gwHeightRC = 0;
 static uint32_t            gwRC = 0;
 static HANDLE            ghStorage = NULL;

=== modified file 'cuneiform_src/Kern/rcorrkegl/src/cpp/cor_kegl.cpp'
--- a/cuneiform_src/Kern/rcorrkegl/src/cpp/cor_kegl.cpp	2010-02-24 14:09:03 +0000
+++ b/cuneiform_src/Kern/rcorrkegl/src/cpp/cor_kegl.cpp	2017-06-01 17:55:52 +0000
@@ -1563,7 +1563,7 @@
   int32_t y2=test->top-main->bottom;
   if (x1>0 || x2>0 || y1>0 || y2>0)   //–Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å
   {
-    x=MAX(x1,x2);  y=max(y1,y2);
+    x=MAX(x1,x2);  y=MAX(y1,y2);
     if (x<0)  return y;
     if (y<0)  return x;
     return MIN(x,y);
@@ -1574,7 +1574,7 @@
   x2=test->right-main->right;
   y1=main->top-test->top;
   y2=test->bottom-main->bottom;
-  x=MAX(x1,x2);  y=max(y1,y2);
+  x=MAX(x1,x2);  y=MAX(y1,y2);
   x=MAX(x,y);
   return (x>0) ? x : 0;
 }

=== modified file 'cuneiform_src/Kern/rcutp/sources/main/rcutp_func.cpp'
--- a/cuneiform_src/Kern/rcutp/sources/main/rcutp_func.cpp	2009-09-19 19:59:21 +0000
+++ b/cuneiform_src/Kern/rcutp/sources/main/rcutp_func.cpp	2017-06-01 17:55:52 +0000
@@ -902,8 +902,8 @@
    if(l1<0 || r1<0) return -1;
    if(i>0)
     {
-     minl=MIN(minl,l1); minr=min(minr,r1);
-     maxl=MAX(maxl,l1); maxr=max(maxr,r1);
+     minl=MIN(minl,l1); minr=MIN(minr,r1);
+     maxl=MAX(maxl,l1); maxr=MAX(maxr,r1);
     }
    else
     {

=== modified file 'cuneiform_src/Kern/rimage/sources/main/cricontrol.cpp'
--- a/cuneiform_src/Kern/rimage/sources/main/cricontrol.cpp	2009-09-19 20:31:22 +0000
+++ b/cuneiform_src/Kern/rimage/sources/main/cricontrol.cpp	2017-06-01 17:55:52 +0000
@@ -594,8 +594,8 @@
 		return FALSE;
 	}
 
-	wNewHeight = (mbMarginsFlag ? abs(mrMargins.rmBottomMarg - mrMargins.rmTopMarg) : mpSourceDIB->GetLinesNumber());
-	wNewWidth = (mbMarginsFlag ? abs(mrMargins.rmLeftMarg - mrMargins.rmRightMarg) : mpSourceDIB->GetLineWidth());
+	wNewHeight = (mbMarginsFlag ? abs((int) (mrMargins.rmBottomMarg - mrMargins.rmTopMarg)) : mpSourceDIB->GetLinesNumber());
+	wNewWidth = (mbMarginsFlag ? abs((int) (mrMargins.rmLeftMarg - mrMargins.rmRightMarg)) : mpSourceDIB->GetLineWidth());
 	mpSourceDIB->GetResolutionDPM( &wXResolution, &wYResolution);
 
 	if ( !mpDestinationDIB->CreateDIBBegin( wNewWidth, wNewHeight, BitCount) )

=== modified file 'cuneiform_src/Kern/rout/src/codetables.cpp'
--- a/cuneiform_src/Kern/rout/src/codetables.cpp	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rout/src/codetables.cpp	2017-06-01 17:55:52 +0000
@@ -937,13 +937,13 @@
  * codepage.
  */
 
-const char * getUTF8Str(const unsigned char in, const int codepage) {
+const unsigned char * getUTF8Str(const unsigned char in, const int codepage) {
   switch(codepage) {
   case 1250 : return win1250_to_utf8[in];
   case 1251 : return win1251_to_utf8[in];
   case 1252 : return win1252_to_utf8[in];
   case 1254 : return win1254_to_utf8[in];
   case 1257 : return win1257_to_utf8[in];
-  default : return "?";
+  default : return reinterpret_cast<const unsigned char*> ("?");
   }
 }

=== modified file 'cuneiform_src/Kern/rout/src/html.cpp'
--- a/cuneiform_src/Kern/rout/src/html.cpp	2010-02-08 12:32:42 +0000
+++ b/cuneiform_src/Kern/rout/src/html.cpp	2017-06-01 17:55:52 +0000
@@ -264,10 +264,10 @@
 				{
 					if (isGoodCharRect(r))
 					{
-						rcLine.left = min(rcLine.left, r.left);
-						rcLine.top = min(rcLine.top, r.top);
-						rcLine.right = max(rcLine.right, r.right);
-						rcLine.bottom = max(rcLine.bottom, r.bottom);
+						rcLine.left = MIN(rcLine.left, r.left);
+						rcLine.top = MIN(rcLine.top, r.top);
+						rcLine.right = MAX(rcLine.right, r.right);
+						rcLine.bottom = MAX(rcLine.bottom, r.bottom);
 					}
 					else
 					{

=== modified file 'cuneiform_src/Kern/rout/src/rout_own.h'
--- a/cuneiform_src/Kern/rout/src/rout_own.h	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rout/src/rout_own.h	2017-06-01 17:55:52 +0000
@@ -458,7 +458,7 @@
 void ResetCodeTables();
 Bool UpdateActiveCodeTable();
 long GetCodePage();
-const char * getUTF8Str(const unsigned char in, const int codepage);
+const unsigned char * getUTF8Str(const unsigned char in, const int codepage);
 
 //*****************************************************************
 // Rout.cpp

=== modified file 'cuneiform_src/Kern/rout/src/text.cpp'
--- a/cuneiform_src/Kern/rout/src/text.cpp	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rout/src/text.cpp	2017-06-01 17:55:52 +0000
@@ -311,7 +311,7 @@
 		}
 		else {
 			const char *utfchar;
-			utfchar = getUTF8Str((char )c2, GetCodePage());
+			utfchar = reinterpret_cast<const char*> (getUTF8Str((char )c2, GetCodePage()));
 			int i;
 			for(i=0; utfchar[i] != '\0' ;i++){
 				*gMemCur++ = utfchar[i];

=== modified file 'cuneiform_src/Kern/rstr/src/defpoint.c'
--- a/cuneiform_src/Kern/rstr/src/defpoint.c	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rstr/src/defpoint.c	2017-06-01 17:55:52 +0000
@@ -530,7 +530,7 @@
         /*¢≠®ß„ ‚‡® ™Æ‡Æ‚™®Â Æ§®≠†™Æ¢ÎÂ*/
         if(ans->h<=chetvert_h && (ans+1)->h<=chetvert_h && (ans+2)->h<=chetvert_h)
          {
-           max_h=MAX(max(ans->h,(ans+1)->h),max((ans+1)->h,(ans+2)->h));
+           max_h=MAX(MAX(ans->h,(ans+1)->h),MAX((ans+1)->h,(ans+2)->h));
            if(ans->h==max_h)      return 6;
            if((ans+1)->h==max_h)  return 8;
            else                   return 7;

=== modified file 'cuneiform_src/Kern/rstr/src/stic_big.c'
--- a/cuneiform_src/Kern/rstr/src/stic_big.c	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rstr/src/stic_big.c	2017-06-01 17:55:52 +0000
@@ -920,7 +920,7 @@
 {
 int16_t dis=0,l_beam = add_flag ? 3 : 5;
 int16_t inc = signums->inc;
-int16_t rc=MAX(r->conc[3],r->conc[4]),lc=max(l->conc[3],l->conc[4]);
+int16_t rc=MAX(r->conc[3],r->conc[4]),lc=MAX(l->conc[3],l->conc[4]);
 int16_t	s=signums->stick_width;
 int16_t L_max=s>>1;	/* 1/2 stick width */
 int16_t rmd,rmu,lmd,lmu;
@@ -983,7 +983,7 @@
 if( typ=='!' && r->mount[0]>5 && l->mount[0]<2 || l->mount[0]>5 && r->mount[0]<2 )
 	dis += tab_vert[3];   /* down flags */
 
-lmu = MAX(l->mount[0],l->mount[1]);  rmu = max(r->mount[0],r->mount[1]);
+lmu = MAX(l->mount[0],l->mount[1]);  rmu = MAX(r->mount[0],r->mount[1]);
 lmd = l->mount[4];  rmd = r->mount[4];
 
 if( lmu+rmu+lmd+rmd != 0 )

=== modified file 'cuneiform_src/Kern/rstr/src/stic_cha.c'
--- a/cuneiform_src/Kern/rstr/src/stic_cha.c	2009-09-19 20:07:01 +0000
+++ b/cuneiform_src/Kern/rstr/src/stic_cha.c	2017-06-01 17:55:52 +0000
@@ -334,7 +334,7 @@
 {
 int16_t l1,l2,r1,r2,dy_u=dy/6,dy_d=dy-1-dy/6,d=(dx-1)<<2;
 
-r1 = MIN(r+4,d); r2 = min(r+8,d); /* r1-one,r2-two step in right direct */
+r1 = MIN(r+4,d); r2 = MIN(r+8,d); /* r1-one,r2-two step in right direct */
 if( r1==r2 )
 	r2 += 4; /* right mode = dx-1 */
 /* upper right serif */
@@ -358,7 +358,7 @@
 	right_chars->down_serif=1;
 }
 
-l2 = MAX(l-8,0); l1 = max(l-4,0);  /* l1-one,l2-two step in left direct */
+l2 = MAX(l-8,0); l1 = MAX(l-4,0);  /* l1-one,l2-two step in left direct */
 
 /* upper left serif */
 if( left_chars->mount[0] && left_chars->m_pos[0]<dy_u )

=== modified file 'cuneiform_src/Kern/rstr/src/stic_dis.c'
--- a/cuneiform_src/Kern/rstr/src/stic_dis.c	2011-02-01 09:28:16 +0000
+++ b/cuneiform_src/Kern/rstr/src/stic_dis.c	2017-06-01 17:55:52 +0000
@@ -512,7 +512,7 @@
 		  int16_t npoints_1_or_2)  {		// 17.01.1994
 int16_t	dis=0;
 int16_t	wid=s->stick_width, inc=s->inc;
-int16_t maxlen = MAX (MAX(l->mount[0],l->mount[4]), max(r->mount[0],l->mount[4]));
+int16_t maxlen = MAX (MAX(l->mount[0],l->mount[4]), MAX(r->mount[0],l->mount[4]));
 
 /*......................................................................*/
 				// 05.08.1993 about DOT:
@@ -605,7 +605,7 @@
 int16_t	tt = (dy>30) ? 2 : 1;	// 25.02.1993	// CAUTION: USED TWICE ######
 //////int16_t	d_L, d_R;	// 04.06.1993
 
-lmu = MAX(l->mount[0],l->mount[1]);  rmu = max(r->mount[0],r->mount[1]);
+lmu = MAX(l->mount[0],l->mount[1]);  rmu = MAX(r->mount[0],r->mount[1]);
 lmd = l->mount[4];  rmd = r->mount[4];
 
 /*......................................................................*/

